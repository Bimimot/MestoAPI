MestoAPI
=============================
Это бэкенд учебного проекта Mesto,
выполненный в ходе обучения в Яндекс.Практикуме


АДРЕС
-----------
http://api.prostomesto.tk
https://api.prostomesto.tk
185.185.68.55


МЕТОДЫ REST API
-----------

| **Метод**  | **Адрес**           	|  **Тело запроса**			              |  **Результат**                                        |
|------------|--------------------------|-----------------------------------------------------|-------------------------------------------------------|
|   GET      |   /users            	|  {} 						      |  список пользователей с полными данными               |
|   GET      |   /users/{id}       	|  {} 						      |  данные пользователя с указанным id                   |
|   PATCH    |   /me               	|  {me, about} 					      |  обновление данных в профиле пользователя             |
|   PATCH    |   /me/avatar        	|  {avatar} 	  				      |  обновление в профиле пользователя ссылки на аватар   |
|   POST     |   /signin           	|  {email, password}				      |  авторизация пользователя			      |
|   POST     |   /signup	   	|  {name, about, avatar,email, password}	      |  создание нового пользователя			      |
|   GET	     |   /cards			|  {}						      |  список карточек с полными данными		      |
|   POST     |   /cards		   	|  {name, link}					      |  создание карточки (название, ссылка на фото)	      |
|   DEL      |   /cards/{cardID}   	|  {}						      |  удаление карточки с указанным cardID		      |
|   PUT	     |   /cards/{cardID}/likes  |  {}						      |  добавление лайка для карточки с указанным cardID     |
|   DEL	     |   /cards/{cardID}/likes  |  {}						      |  снятие лайка для карточки с указанным cardID	      |
|   GET	     |   /crash-test	        |  {}						      |  принудительное обрушение сервера для проверки	      |


ДОСТУП К API
-----------
Все маршруты API защищены авторизацией, кроме:
- /signup (создание пользователя)
- /signin (авторизация пользователя)


ОБРАБОТКА ОШИБОК
-----------
Реализована централизованная обработка ошибок и вывод кастомных сообщения в случаях:

| **Код ошибки**  |  **Сообщение**                        	|  **Причины**    		                 					   |  
|-----------------|---------------------------------------------|------------------------------------------------------------------------------------------|
|   400	          |  В запросе указаны неправильные данные	|  Данные, переданные в теле запросе, не прошли валидацию 				   |
|   401           |  Необходима авторизация               	|  В заголовке запроса нет авторизации, тип авторизации не Bearer, передан неверный токен  |
|   401           |  Неправильные почта или пароль        	|  При обращении на маршрут /signin переданы неверный email либо пароль 		   |
|   403           |  Нет прав на удаление этой карточки   	|  Метод DEL по маршруту /cards/{cardID} вызван не владельцем карточки  	 	   |
|   404           |  Такой пользователь не найден         	|  Вызов метода GET по маршруту /users/{id} с несуществующим id	   		 	   |
|   404           |  Карточка с таким id не найдена       	|  Вызов методов обработки карточек по маршруту с несуществующим cardId   	 	   |
|   404           |  Такой ресурс не найден		       	|  Запрос по несуществующему адресу					   	 	   |
|   409           |  Пользователь с таким email уже существует 	|  Вызов метода PUT по маршруту /signup с неуникальным email		  	 	   |
|   500           |  На сервере произошла ошибка       	  	|  Любая иная ошибка при обработке запроса				 	 	   |
|   500           |  Сервер сейчас упадет       	  	|  Вызов метода GET по адресу /crash-test для проверки автоматического восстановления	   |

В режиме разработки (NODE_ENV !== 'production') для ошибок 400 и 500 возвращается полный текст ошибки без замены на кастомное сообщение.


РЕШЕННЫЕ ЗАДАЧИ
-----------
- настроен линтер
- поднят сервер Mongo
- созданы схемы и модели Mongo
- созданы контроллеры и роутуы для указанных методов
- передаваемые значения корректно валидируются
- пароли в базе хранятся в захешированном виде
- создана мидлвэра авторизации, маршрурты закрыты авториазцией
- исключена возможность удаления чужих карточек
- хеша пароля возвращается из базы только при аутентификации
- реализована мидлвэра централизованной обработки ошибок
- реализовано логирование запросов и ошибок в файлах request.log и error.log
- API поднято на облачном сервере
- подключены сертификаты для работы по https
- настроены переменные окружения на сервере в файле .env (ключ для создания токенов, режим работы приложения)


АВТОР
-----------
Попов Степан